\directlua{
    chapter_names = {}
    chapter_names[1] = "A Day of Very Low Probability"
    chapter_names[2] = "Everything I Believe Is False"
    chapter_names[3] = "Comparing Reality To Its Alternatives"
    chapter_names[4] = "The Efficient Market Hypothesis"
    chapter_names[5] = "The Fundamental Attribution Error"
    chapter_names[6] = "The Planning Fallacy"
    chapter_names[7] = "Reciprocation"
    chapter_names[8] = "Positive Bias"
    chapter_names[9] = "Self Awareness, Part I"
    chapter_names[10] = "Self Awareness, Part II"
    chapter_names[11] = "Omake Files I, II, III"
    chapter_names[12] = "Impulse Control"
    chapter_names[13] = "Asking the Wrong Questions"
    chapter_names[14] = "The Unknown and the Unknowable"
    chapter_names[15] = "Conscientiousness"
    chapter_names[16] = "Lateral Thinking"
    chapter_names[17] = "Locating the Hypothesis"
    chapter_names[18] = "Dominance Hierarchies"
    chapter_names[19] = "Delayed Gratification"
    chapter_names[20] = "Bayes's Theorem"
    chapter_names[21] = "Rationalization"
    chapter_names[22] = "The Scientific Method"
    chapter_names[23] = "Belief in Belief"
    chapter_names[24] = "Machiavellian Intelligence Hypothesis"
    chapter_names[25] = "Hold Off on Proposing Solutions"
    chapter_names[26] = "Noticing Confusion"
    chapter_names[27] = "Empathy"
    chapter_names[28] = "Reductionism"
    chapter_names[29] = "Egocentric Bias"
    chapter_names[30] = "Working in Groups, Part I"
    chapter_names[31] = "Working in Groups, Part II"
    chapter_names[32] = "Interlude: Personal Financial Management"
    chapter_names[33] = "Coordination Problems, Part I"
    chapter_names[34] = "Coordination Problems, Part II"
    chapter_names[35] = "Coordination Problems, Part III"
    chapter_names[36] = "Status Differentials"
    chapter_names[37] = "Interlude: Crossing the Boundary"
    chapter_names[38] = "The Cardinal Sin"
    chapter_names[39] = "Pretending to be Wise, Part I"
    chapter_names[40] = "Pretending to be Wise, Part II"
    chapter_names[41] = "Frontal Override"
    chapter_names[42] = "Courage"
    chapter_names[43] = "Humanism, Part I"
    chapter_names[44] = "Humanism, Part II"
    chapter_names[45] = "Humanism, Part III"
    chapter_names[46] = "Humanism, Part IV"
    chapter_names[47] = "Personhood Theory"
    chapter_names[48] = "Utilitarian Priorities"
    chapter_names[49] = "Prior Information"
    chapter_names[50] = "Self Centeredness"
    chapter_names[51] = "Title Redacted, Part I"
    chapter_names[52] = "The Stanford Prison Experiment, Part II"
    chapter_names[53] = "The Stanford Prison Experiment, Part III"
    chapter_names[54] = "The Stanford Prison Experiment, Part IV"
    chapter_names[55] = "The Stanford Prison Experiment, Part V"
    chapter_names[56] = "TSPE, Constrained OPartimization, Part VI"
    chapter_names[57] = "TSPE, Constrained Cognition, Part VII"
    chapter_names[58] = "TSPE, Constrained Cognition, Part VIII"
    chapter_names[59] = "TSPE, Curiosity, Part IX"
    chapter_names[60] = "The Stanford Prison Experiment, Part X"
    chapter_names[61] = "TSPE, Secrecy and Openness, Part XI"
    chapter_names[62] = "The Stanford Prison Experiment, Final"
    chapter_names[63] = "TSPE, Aftermaths"
    chapter_names[64] = "Omake Files VI, Alternate Parallels"
    chapter_names[65] = "Contagious Lies"
    chapter_names[66] = "Self Actualization, Part I"
    chapter_names[67] = "Self Actualization, Part II"
    chapter_names[68] = "Self Actualization, Part III"
    chapter_names[69] = "Self Actualization, Part IV"
    chapter_names[70] = "Self Actualization, Part V"
    chapter_names[71] = "Self Actualization, Part VI"
    chapter_names[72] = "SA, Plausible Deniability, Part VII"
    chapter_names[73] = "SA, The Sacred and the Mundane, Part VIII"
    chapter_names[74] = "SA, Escalation of Conflicts, Part IX"
    chapter_names[75] = "Self Actualization Final, Responsibility"
    chapter_names[76] = "Interlude with the Confessor: Sunk Costs"
    chapter_names[77] = "SA, Aftermaths: Surface Appearances"
    chapter_names[78] = "Taboo Tradeoffs Prelude: Cheating"
    chapter_names[79] = "Taboo Tradeoffs, Part I"
    chapter_names[80] = "Taboo Tradeoffs, Part II, The Horns Effect"
    chapter_names[81] = "Taboo Tradeoffs, Part III"
    chapter_names[82] = "Taboo Tradeoffs, Final"
    chapter_names[83] = "Taboo Tradeoffs, Aftermath I"
    chapter_names[84] = "Taboo Tradeoffs, Aftermath II"
    chapter_names[85] = "Taboo Tradeoffs, Aftermath III, Distance"
    chapter_names[86] = "Multiple Hypothesis Testing"
    chapter_names[87] = "Hedonic Awareness"
    chapter_names[88] = "Time Pressure, Part I"
    chapter_names[89] = "Time Pressure, Part II"
    chapter_names[90] = "Roles, Part I"
    chapter_names[91] = "Roles, Part II"
    chapter_names[92] = "Roles, Part III"
    chapter_names[93] = "Roles, Part IV"
    chapter_names[94] = "Roles, Part V"
    chapter_names[95] = "Roles, Part VI"
    chapter_names[96] = "Roles, Part VII"
    chapter_names[97] = "Roles, Part VIII"
    chapter_names[98] = "Roles, Final"
    chapter_names[99] = "Roles, Aftermath"
    chapter_names[100] = "Precautionary Measures, Part I"
    chapter_names[101] = "Precautionary Measures, Part II"
    chapter_names[102] = "Caring"
    chapter_names[103] = "Tests"
    chapter_names[104] = "The Truth, Part I, Riddles and Answers"
    chapter_names[105] = "The Truth, Part II"
    chapter_names[106] = "The Truth, Part III"
    chapter_names[107] = "The Truth, Part IV"
    chapter_names[108] = "The Truth, Part V, Answers and Riddles"
    chapter_names[109] = "Reflections"
    chapter_names[110] = "Reflections, Part II"
    chapter_names[111] = "Failure, Part I"
    chapter_names[112] = "Failure, Part II"
    chapter_names[113] = "Final Exam"
    chapter_names[114] = "Shut Up and Do The Impossible"
    chapter_names[115] = "Shut Up and Do The Impossible, Part II"
    chapter_names[116] = "Aftermath, Something to Protect, Part 0"
    chapter_names[117] = "Something to Protect: Minerva McGonagall"
    chapter_names[118] = "Something to Protect: Professor Quirrell"
    chapter_names[119] = "Something to Protect: Albus Dumbledore"
    chapter_names[120] = "Something to Protect: Draco Malfoy"
    chapter_names[121] = "Something to Protect: Severus Snape"
    chapter_names[122] = "Something to Protect: Hermione Granger"
}

\newcommand{\ChapterName}[1]{\directlua{tex.print(chapter_names[#1])}}

\newcommand{\ChapterNum}[1]{\directlua{%
    chapters = {\hpBookChapters}
    first_chap = chapters[1]
    extra = 0
    if \hpBookNo == 1 and #1 > 11 then
    extra = 1
    end
    tex.sprint(#1 - first_chap - extra + 1) -- add one because chapters start is inclusive
}}
